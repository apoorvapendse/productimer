<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productimer</title>
    <link rel="stylesheet" href="slider.css">
    <link rel="stylesheet" href="home.css">
    <link rel="stylesheet" href="navicon.css">
  
    <script src="https://code.jquery.com/jquery-3.2.1.js"></script>
                                    
    <link href="https://cdn.jsdelivr.net/npm/round-slider@1.6.1/dist/roundslider.min.css" rel="stylesheet" />
                                        
    <script src="https://cdn.jsdelivr.net/npm/round-slider@1.6.1/dist/roundslider.min.js"></script>
    

  
</head>
<body>

    <div id="sidemenuButton" onclick="toggleMenu()" >
        <span></span>
        <span></span>
        <span></span>
    </div>
    <div id="seeds">
       
    </div>
    <div id="number">

    </div>
    <div class="container">
      
            <div class="sliderContainer">

                <div id="slider" class="slider"></div>
            </div>
            
       
        <button id="plant"><h3>PLANT</h3></button>
        <h2 id="homeQuote">
            <%=quote %>
        </h2>

        <div id="notif" ></div>

    </div>
    <div id="menu" >
        <div class="options">
            <ul class="optionsList">
                <li>Forest</li>
                <li>Timeline</li>
                <li>Tags</li>
                <li>Friends</li>
                <li>Achievements</li>
                <li>Store</li>
                <li>About</li>
                <li>Settings</li>
                <li>
                    <form action="/logout" method="post">

                        <button id="logoutBtn">
                             Logout
                        </button>
                    </form>
                </li>

            </ul>
            

        </div>
    </div>

    
    <script >
       const toggleMenu = ()=>{
        const menu = document.getElementById("menu");
        menu.classList.toggle('menuToggle')
       }
    </script>


    <script>

let selectedDuration=0;
let isPlanted = false;
let timer;


        $("#slider").roundSlider({
    radius: 135,
    sliderType: "min-range",
    value: 45,
    handleSize:20,
    width:22,
    min:0,
    max:180,
    step:1,
    create: "traceEvent",
   start:"traceEvent",
    stop: "traceEvent",
    change:"traceEvent"
   


});


function traceEvent(e) {
   selectedDuration= e.value;
   console.log("currDur:",selectedDuration)
}

function padWithLeadingZeros(num, totalLength) {
  return String(num).padStart(totalLength, '0');
}
    const msgBox = document.getElementById('notif')
    const plantBtn = document.getElementById("plant");
    const timeDisplay = document.querySelector('.rs-tooltip-text');
    
    plantBtn.addEventListener("click",()=>{
        if(isPlanted===false){
            isPlanted=true;
            plantBtn.innerText="Kill PlantðŸ˜”"
            plantBtn.style.color="red"
            plantBtn.style.fontWeight="bold"
            timeDisplay.style.paddingRight = '70px'
            timeDisplay.style.border = 'none'

            //tree is not planted, so plant it now
            let durationInSeconds = selectedDuration*60;
            
            
             timer = setInterval(() => {
                
                let Seconds = durationInSeconds%60;
                
                let Minutes = Math.floor(durationInSeconds/60); 

                let SecondsString = padWithLeadingZeros(Seconds,2)
                
                
                durationInSeconds--;
                $("#slider").roundSlider({
                    value:Seconds,
                    step:0.1,
                    max:durationInSeconds,
                    min:0
                })
                
                timeDisplay.innerText = `${Minutes}:${SecondsString}`
                if(durationInSeconds<=0){
                    clearInterval(timer);
                    msgBox.innerText = `Congrats! You focussed for ${selectedDuration} minutes straight!`
                    msgBox.classList.add("glideDown");

                }
            }, 1000);
           
        }
        else{
            clearInterval(timer);
            timeDisplay.style.paddingRight = '5px'
            timeDisplay.style.marginLeft = '-32px'
            timeDisplay.style.border = '1px solid white'

            isPlanted=false;
            plantBtn.innerText="Plant"
            plantBtn.style.color="blue"
            $("#slider").roundSlider({
             radius: 135,
            sliderType: "min-range",
            value: 45,
            handleSize:20,
            width:22,
            min:0,
            max:180,
            step:1,
            create: "traceEvent",
            start:"traceEvent",
            stop: "traceEvent",
            change:"traceEvent"
   


});




        }
        
      
   


});
        
       
        

        




    

    </script>



    
</script>
   
</body>
</html>